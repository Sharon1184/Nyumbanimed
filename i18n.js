const translations = {
    en: {
        // Navigation and Global
        app_name: "NyumbaCare TZ",
        nav_home: "Home",
        nav_find_provider: "Find Provider",
        nav_book: "Book",
        nav_chat: "Chat",
        nav_profile: "Profile",

        // Home Page
        home_title: "NyumbaCare TZ - Home",
        hero_heading: "Quality Healthcare at Your Doorstep",
        hero_subheading: "Find and book trusted healthcare providers in Tanzania.",
        learn_more_btn: "Learn More",
        services_heading: "Our Services",
        service_home_care: "Home Care",
        service_home_care_desc: "Professional nursing and medical care in the comfort of your home.",
        service_appointments: "Appointments",
        service_appointments_desc: "Book appointments with certified doctors, nurses, and midwives.",
        service_chat: "Chat",
        service_chat_desc: "Securely chat with providers for advice and consultation.",

        // Find Provider Page
        find_provider_title: "NyumbaCare TZ - Find Provider",
        find_provider_heading: "Find a Provider",
        cta_heading: "Are you a healthcare provider?",
        cta_text: "Join our network and connect with clients seeking your services.",
        cta_button: "Register Now",

        // Registration Page
        register_title: "NyumbaCare TZ - Register",
        register_heading: "Create Your Account",
        register_subheading: "Join us as a patient or a healthcare provider.",
        patient_role: "Patient",
        provider_role: "Provider",
        full_name_label: "Full Name",
        email_label: "Email Address",
        password_label: "Password",
        confirm_password_label: "Confirm Password",
        specialization_label: "Specialization",
        select_specialization_option: "Select a specialization",
        specialization_nurse: "Nurse",
        specialization_doctor: "Doctor",
        specialization_midwife: "Midwife",
        license_upload_label: "Upload License/Credential (PDF, JPG)",
        register_btn: "Register",
        success_heading: "Registration Submitted!",
        success_text: "Your details have been submitted for review. We will contact you once your profile has been approved.",
        back_to_providers_btn: "Back to Providers",

        // Booking Page
        book_appointment_title: "NyumbaCare TZ - Book Appointment",
        book_appointment_heading: "Book an Appointment",
        provider: "Provider",
        specialty: "Specialty",
        location: "Location",
        error_no_provider_selected: "Error: No provider selected.",
        provider_not_found: "Provider not found.",
        error_loading_provider: "Error loading provider details.",
        submitting_btn_text: "Submitting...",
        appointment_success_message: "Appointment booked successfully! The provider will confirm shortly.",
        appointment_error_message: "Error booking appointment. Please try again.",
        book_appointment_btn: "Book Appointment",
        appointment_details_heading: "Appointment Details",
        patient_name_label: "Your Full Name",
        appointment_date_label: "Date",
        appointment_time_label: "Time",
        patient_symptoms_label: "Describe your symptoms or reason for booking",
        
        // Chat Page
        chat_title: "NyumbaCare TZ - Chat",
        chat_heading: "Live Chat",
        chat_with: "Chat with {providerName}",
        placeholder_chat_input: "Type a message...",
        hi_message: "Hi {username}, how can I help you today?",
    },
    sw: {
        // Navigation and Global
        app_name: "NyumbaCare TZ",
        nav_home: "Mwanzo",
        nav_find_provider: "Tafuta Mtoa Huduma",
        nav_book: "Weka Miadi",
        nav_chat: "Ongea",
        nav_profile: "Wasifu",

        // Home Page
        home_title: "NyumbaCare TZ - Mwanzo",
        hero_heading: "Huduma Bora za Afya Hadi Mlangoni Kwako",
        hero_subheading: "Pata na uweke miadi na watoa huduma za afya wanaoaminika Tanzania.",
        learn_more_btn: "Jifunze Zaidi",
        services_heading: "Huduma Zetu",
        service_home_care: "Huduma ya Nyumbani",
        service_home_care_desc: "Uuguzi wa kitaalamu na huduma za matibabu popote ulipo.",
        service_appointments: "Miadi",
        service_appointments_desc: "Weka miadi na madaktari, wauguzi, na wakunga walioidhinishwa.",
        service_chat: "Ongea",
        service_chat_desc: "Ongea kwa usalama na watoa huduma kwa ushauri.",

        // Find Provider Page
        find_provider_title: "NyumbaCare TZ - Tafuta Mtoa Huduma",
        find_provider_heading: "Tafuta Mtoa Huduma",
        cta_heading: "Je, wewe ni mtoa huduma wa afya?",
        cta_text: "Jiunge na mtandao wetu na unganisha na wateja wanaohitaji huduma zako.",
        cta_button: "Jisajili Sasa",

        // Registration Page
        register_title: "NyumbaCare TZ - Jisajili",
        register_heading: "Fungua Akaunti Yako",
        register_subheading: "Jiunge nasi kama mgonjwa au mtoa huduma wa afya.",
        patient_role: "Mgonjwa",
        provider_role: "Mtoa Huduma",
        full_name_label: "Jina Kamili",
        email_label: "Barua Pepe",
        password_label: "Neno Siri",
        confirm_password_label: "Thibitisha Neno Siri",
        specialization_label: "Utaalam",
        select_specialization_option: "Chagua utaalam",
        specialization_nurse: "Muuguzi",
        specialization_doctor: "Daktari",
        specialization_midwife: "Mkunga",
        license_upload_label: "Pakia Leseni/Cheti (PDF, JPG)",
        register_btn: "Jisajili",
        success_heading: "Usajili Umepokelewa!",
        success_text: "Maelezo yako yamewasilishwa kwa ajili ya uhakiki. Tutakupigia mara tu wasifu wako utakapoidhinishwa.",
        back_to_providers_btn: "Rudi kwa Watoa Huduma",

        // Booking Page
        book_appointment_title: "NyumbaCare TZ - Weka Miadi",
        book_appointment_heading: "Weka Miadi",
        provider: "Mtoa Huduma",
        specialty: "Utaalam",
        location: "Eneo",
        error_no_provider_selected: "Hitilafu: Hakuna mtoa huduma aliyechaguliwa.",
        provider_not_found: "Mtoa huduma hakupatikana.",
        error_loading_provider: "Hitilafu ya kupakia maelezo ya mtoa huduma.",
        submitting_btn_text: "Inatuma...",
        appointment_success_message: "Miadi imewekwa kwa ufanisi! Mtoa huduma atathibitisha hivi karibuni.",
        appointment_error_message: "Hitilafu ya kuweka miadi. Tafadhali jaribu tena.",
        book_appointment_btn: "Weka Miadi",
        appointment_details_heading: "Maelezo ya Miadi",
        patient_name_label: "Jina Lako Kamili",
        appointment_date_label: "Tarehe",
        appointment_time_label: "Saa",
        patient_symptoms_label: "Eleza dalili zako au sababu ya kuweka miadi",

        // Chat Page
        chat_title: "NyumbaCare TZ - Ongea",
        chat_heading: "Ongea Moja kwa Moja",
        chat_with: "Ongea na {providerName}",
        placeholder_chat_input: "Andika ujumbe...",
        hi_message: "Habari {username}, ninaweza kukusaidiaje?",
    }
};

document.addEventListener('DOMContentLoaded', () => {
    const elements = document.querySelectorAll('[data-i18n]');
    const langBtns = document.querySelectorAll('.lang-btn');

    const setLanguage = (lang) => {
        elements.forEach(element => {
            const key = element.getAttribute('data-i18n');
            const translation = translations[lang] ? translations[lang][key] : undefined;
            if (translation) {
                // Check if the element is an input to update its placeholder
                if (element.tagName === 'INPUT' && element.hasAttribute('placeholder')) {
                    element.placeholder = translation;
                } else {
                    element.textContent = translation;
                }
            }
        });

        langBtns.forEach(btn => {
            if (btn.id === `lang-${lang}`) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
            }
        });

        localStorage.setItem('lang', lang);
    };

    const savedLang = localStorage.getItem('lang') || 'en';
    setLanguage(savedLang);

    langBtns.forEach(btn => {
        btn.addEventListener('click', (event) => {
            const lang = event.target.id.replace('lang-', '');
            setLanguage(lang);
        });
    });

    window.i18n = {
        t: (key, replacements = {}) => {
            const currentLang = localStorage.getItem('lang') || 'en';
            let translation = translations[currentLang][key] || key;
            
            // Replace dynamic placeholders like {username}
            for (const placeholder in replacements) {
                translation = translation.replace(`{${placeholder}}`, replacements[placeholder]);
            }
            return translation;
        }
    };
});